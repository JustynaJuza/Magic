@using Magic.Hubs;
@using Microsoft.AspNet.Identity

<div id="user-list-overlay"></div>
<div id="user-list-add-member-container" style="overflow: auto; height: 220px;">
    <ul id="user-list-add-member">
        <li class="chat-user" />
    </ul>
</div>

<div class="chat container">

    <h3>
        Hello@{ if (Request.IsAuthenticated)
         { <span id=user_name>@User.Identity.GetUserName()</span>} }!
    </h3>

    <input id="chat-room-selection" class="btn btn-primary" type="hidden" value="default" />

    <ul id="chat-room-selectlist">
        <li id="default">
            All
        </li>
    </ul>

    <div id="chat_room_container">
        @{Html.RenderAction("GetChatRoomPartial", "Chat");}

        @*<div id="chat_room_container">
                <div id="chat_room-default" class="container chat-room">

                    <div class="container right" style="margin: 0px 0px 0px 6px; width: 100px; height: 255px">
                        <ul id="chat-room-users-selectlist" style="list-style-type: none; height: 34px; overflow: hidden; white-space: nowrap; padding:0px">
                            <li class="chat-room-users-selection" style="width: 100%;">
                                Online
                            </li>
                        </ul>

                        <div class="form-control " id="chat_users_container" style="overflow: auto; height: 221px; border-top-left-radius: 0; border-top-right-radius: 0;">
                            <ul id="chat_users-default" class="chat-users">
                                <li class="chat-user" />
                            </ul>
                        </div>
                    </div>

                    <div class="container left">

                        @if (Request.IsAuthenticated)
                        {
                            //@: Please show class and be polite and respectful towards other people.

                            <div class="container" style="margin: 0px 0px 3px 0px; white-space: nowrap;">

                                @Html.TextBox("new-chat-message", null, new { id = "new-chat-message", @class = "form-control", style = "width:100%; max-width: 100%; display:inline; margin: 0px -63px 3px 0px; padding-right: 67px" })
                                <input type="button" id="new-chat-message-send" class="btn btn-primary" value="Send" style="width: 60px; display: inline; margin: 0px 0px 3px 0px;" />

                                <ul id="chat-room-selectlist" style="position: absolute; width: auto; display: none; list-style-type: none; background: #ffd800; margin:-3px 0px 0px 0px">
                                        <li id="default">All</li>
                                    </ul>
                            </div>
                        }
                        else
                        {
                            //@: Log in to take part in the chat conversation with other users!
                        }

                        <div id="chat_messages_container" class="form-control" style="height: 215px; overflow: auto;">
                            <ul id="chat_messages-default" class="chat-messages">
                                @{ var recentLog = ChatHub.GetRecentChatLog();
                                     if (recentLog != null)
                                     {
                                         foreach (var message in recentLog)
                                         {
                                            <li class="chat-message">
                                                @message.TimeSend.Value.ToString("HH:mm:ss") <span class="chat-message-sender" style="font-weight:bold">@message.Sender.UserName</span>
                                                @if (message.Recipient != null)
                                                {
                                                    <span class="chat-message-recipient" style="font-weight:bold">@@@message.Recipient.UserName</span>
                                                }
                                                @message.Message
                                            </li>
                                         }
                                     }
                                    }
                            </ul>
                        </div>

                    </div>
                </div>
            </div>*@

        @*<input type="checkbox" id="chat-messages-general-check" checked="checked"> General chat.
            <input type="checkbox" id="chat-messages-private-check" checked="checked"> Private chat.*@

    </div>
</div>

@*----------------------------------------------------- SCRIPT -----------------------------------------------------*@
@Scripts.Render("~/bundles/jquerysignalR")
@Scripts.Render("~/signalr/hubs")
@Scripts.Render("~/Scripts/_chat.js")
@*@Scripts.Render("~/Scripts/_hub-start.js")*@
